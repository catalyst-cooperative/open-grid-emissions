---------------------------------------------
April 19, 2022
---------------------------------------------
- fixing incorrect prime movers
- fixing matchup between EIA and EPA/eGRID ids
- removing non-grid connected plants

### Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   co2_mass_tons_unadjusted |
|:----------------------|---------------------:|-------------------:|----------------:|---------------------------:|
| !exact                |                 9854 |               8096 |            7398 |                       8232 |
| +/-1%                 |                   28 |                544 |             595 |                        730 |
| +/-10%                |                   62 |                318 |             399 |                        473 |
| +/-50%                |                   38 |                282 |             329 |                        310 |
| <50%                  |                    5 |                  6 |               4 |                         12 |
| >50%                  |                   49 |                776 |            1184 |                        151 |
| missing               |                    1 |                  2 |               1 |                          1 |
| missing_in_calc       |                    2 |                  1 |               1 |                         10 |
| missing_in_egrid      |                    3 |                 56 |             161 |                        161 |
| missing_zero_in_calc  |                    9 |                  9 |              10 |                          1 |
| missing_zero_in_egrid |                  337 |                302 |             308 |                        308 |
| negative              |                    6 |                  2 |               4 |                          5 |
| Total                 |                10394 |              10394 |           10394 |                      10394 |


### BA Metric
| ba_code   |   co2_mass_tons |   heat_input_mmbtu |   net_generation_mwh |   num_plants |
|:----------|----------------:|-------------------:|---------------------:|-------------:|
| nan       |           0.29  |              0.339 |                0.309 |            8 |
| TEPC      |           0.859 |              0.818 |                0.697 |            0 |
| DEAA      |           0.997 |              0.997 |                1     |            0 |
| GRIF      |           0.999 |              0.999 |                1     |            0 |
| OVEC      |           1     |              1     |                1     |            0 |
| CSTO      |           1     |              1     |                1     |            0 |
| NSB       |           1     |              1     |                1     |            0 |
| SPA       |           1     |              1     |                1     |            1 |
| CEA       |           1     |              1     |                1     |            0 |
| WAUW      |           1     |              1     |                1     |            0 |
| WWA       |           1     |              1     |                1     |            0 |
| GWA       |           1     |              1     |                1     |            0 |
| GRIS      |           1     |              1     |                1     |            0 |
| GCPD      |           1     |              1     |                1     |            0 |
| DOPD      |           1     |              1     |                1     |            0 |
| YAD       |           1     |              1     |                1     |            0 |
| CPLW      |           1     |              1     |                1     |            0 |
| CHPD      |           1     |              1     |                1     |            0 |
| LGEE      |           1.001 |              1.001 |                1     |            0 |
| SEC       |           1.001 |              0.999 |                1     |            0 |
| TIDC      |           1.001 |              1.001 |                1     |            0 |
| EEI       |           1.002 |              1.004 |                1     |            0 |
| AECI      |           1.003 |              1.003 |                1     |            6 |
| AVRN      |           1.003 |              1.001 |                1     |            0 |
| FMPP      |           1.008 |              1.003 |                1     |            1 |
| AEC       |           1.013 |              1.003 |                1     |            0 |
| WALC      |           1.016 |              1.006 |                1     |            1 |
| TEC       |           1.02  |              0.986 |                1     |            1 |
| PSCO      |           1.028 |              1.014 |                1.009 |            3 |
| EPE       |           1.03  |              1.023 |                1     |            0 |
| PACE      |           1.051 |              1.057 |                1     |            4 |
| LDWP      |           1.054 |              1.05  |                1     |            7 |
| PNM       |           1.063 |              1.057 |                1.068 |            2 |
| NWMT      |           1.064 |              1.043 |                1     |            1 |
| HST       |           1.068 |              1     |                1     |            0 |
| HECO      |           1.092 |              1.025 |                1     |            2 |
| SWPP      |           1.103 |              1.145 |                1.008 |           23 |
| AZPS      |           1.106 |              1.112 |                1.041 |            1 |
| DUK       |           1.11  |              2.499 |                0.998 |            5 |
| PGE       |           1.113 |              1.085 |                1.222 |            5 |
| TAL       |           1.116 |              1.112 |                1     |            0 |
| TVA       |           1.128 |              1.864 |                1     |            2 |
| NEVP      |           1.131 |              1.082 |                1.029 |            2 |
| BANC      |           1.137 |              1.087 |                1.042 |            2 |
| WACM      |           1.152 |              1.127 |                1.137 |            4 |
| ERCO      |           1.154 |              1.285 |                1.012 |            4 |
| PJM       |           1.159 |              1.764 |                1.022 |           37 |
| FPL       |           1.178 |              1.528 |                1.074 |            2 |
| SC        |           1.2   |              1.102 |                1     |            0 |
| FPC       |           1.207 |              1.098 |                1     |            1 |
| MISO      |           1.286 |              1.431 |                1.018 |           63 |
| SCEG      |           1.347 |              1.714 |                1     |            2 |
| SOCO      |           1.417 |              1.542 |                1.006 |           14 |
| NYIS      |           1.425 |              1.688 |                1.031 |           31 |
| GVL       |           1.432 |              1.009 |                1.01  |            0 |
| CISO      |           1.47  |              1.247 |                0.995 |           62 |
| PSEI      |           1.489 |              1.28  |                1     |            1 |
| SRP       |           1.506 |              3.054 |                1.093 |            4 |
| IPCO      |           1.527 |              1.063 |                1     |            0 |
| ISNE      |           1.567 |              1.631 |                1.025 |           18 |
| BPAT      |           1.664 |              1.186 |                1     |            5 |
| JEA       |           1.686 |              1.597 |                1.301 |            0 |
| CPLE      |           1.83  |              2.838 |                1     |            7 |
| IID       |           1.995 |              1.053 |                1     |            1 |
| PACW      |           2.178 |              1.096 |                1     |            3 |
| AVA       |           3.451 |              1.245 |                1     |            1 |
| SCL       |          22.324 |              1.023 |                1     |            0 |
| NBSO      |          33.916 |              2.611 |                1     |            0 |
| TPWR      |         189.152 |              1.321 |                1     |            0 |
| AMPL      |        1883.53  |              1     |                1     |            0 |
| SEPA      |      441183     |              1.016 |                1     |            1 |
| HGMA      |         nan     |            nan     |              nan     |          nan |



---------------------------------------------
April 16, 2022
---------------------------------------------
- updated output metrics to deal with null values and add more categories
- [x] Figure out why output metrics don't have the same number of plants
- [x] Downloaded updated version of pudl database (v6.0.0)
- [x] Manually fix incorrect BA assignments
- [x] Fix BA assignments
- [x] Add plant count to BA metric
- fixed issue where certain generators were being dropped from the EIA gen allocation

### Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   co2_mass_tons_unadjusted |
|:----------------------|---------------------:|-------------------:|----------------:|---------------------------:|
| !exact                |                10159 |               8102 |            7555 |                       8388 |
| +/-1%                 |                   27 |                543 |             594 |                        728 |
| +/-10%                |                   63 |                321 |             402 |                        476 |
| +/-50%                |                   42 |                280 |             327 |                        309 |
| <50%                  |                   15 |                 10 |               8 |                         16 |
| >50%                  |                   49 |                772 |            1180 |                        148 |
| missing               |                    1 |                 10 |               1 |                          1 |
| missing_in_calc       |                   46 |                 37 |              23 |                         32 |
| missing_in_egrid      |                   15 |                 61 |             174 |                        174 |
| missing_zero_in_calc  |                    9 |                  9 |              32 |                         23 |
| missing_zero_in_egrid |                    1 |                286 |             133 |                        133 |
| negative              |                    6 |                  2 |               4 |                          5 |
| Total                 |                10433 |              10433 |           10433 |                      10433 |

### BA Metric
| ba_code   |   co2_mass_tons |   heat_input_mmbtu |   net_generation_mwh |   num_plants |
|:----------|----------------:|-------------------:|---------------------:|-------------:|
| nan       |           0.309 |              0.363 |                0.322 |          -32 |
| TEPC      |           0.859 |              0.818 |                0.697 |            0 |
| DEAA      |           0.997 |              0.997 |                1     |            0 |
| GRIF      |           0.999 |              0.999 |                1     |            0 |
| OVEC      |           1     |              1     |                1     |            0 |
| CSTO      |           1     |              1     |                1     |            0 |
| NSB       |           1     |              1     |                1     |            0 |
| SPA       |           1     |              1     |                1     |            0 |
| CEA       |           1     |              1     |                1     |            0 |
| WAUW      |           1     |              1     |                1     |            0 |
| WWA       |           1     |              1     |                1     |            0 |
| GWA       |           1     |              1     |                1     |            0 |
| GRIS      |           1     |              1     |                1     |            0 |
| GCPD      |           1     |              1     |                1     |            0 |
| DOPD      |           1     |              1     |                1     |            0 |
| YAD       |           1     |              1     |                1     |            0 |
| CHPD      |           1     |              1     |                1     |            0 |
| CPLW      |           1     |              1     |                1     |            0 |
| LGEE      |           1.001 |              1.001 |                1     |            0 |
| SEC       |           1.001 |              0.999 |                1     |            0 |
| TIDC      |           1.001 |              1.001 |                1     |            0 |
| EEI       |           1.002 |              1.004 |                1     |            0 |
| AECI      |           1.003 |              1.003 |                1     |            0 |
| AVRN      |           1.003 |              1.001 |                1     |            0 |
| FMPP      |           1.008 |              1.003 |                1     |            0 |
| AEC       |           1.013 |              1.003 |                1     |            0 |
| WALC      |           1.016 |              1.006 |                1     |            0 |
| PSCO      |           1.028 |              1.014 |                1.009 |            0 |
| EPE       |           1.03  |              1.023 |                1     |            0 |
| PACE      |           1.051 |              1.057 |                1     |            0 |
| LDWP      |           1.054 |              1.05  |                1     |            0 |
| PNM       |           1.063 |              1.057 |                1.068 |            0 |
| NWMT      |           1.064 |              1.043 |                1     |            0 |
| HST       |           1.068 |              1     |                1     |            0 |
| TEC       |           1.073 |              1.036 |                1     |            0 |
| HECO      |           1.092 |              1.025 |                1     |            0 |
| SWPP      |           1.103 |              1.145 |                1.007 |           -1 |
| AZPS      |           1.106 |              1.112 |                1.041 |            0 |
| DUK       |           1.11  |              2.498 |                0.998 |            0 |
| PGE       |           1.113 |              1.085 |                1.222 |            0 |
| TAL       |           1.116 |              1.112 |                1     |            0 |
| TVA       |           1.128 |              1.864 |                1     |            0 |
| NEVP      |           1.131 |              1.082 |                1.029 |            0 |
| BANC      |           1.137 |              1.087 |                1.042 |            0 |
| WACM      |           1.152 |              1.127 |                1.137 |            0 |
| ERCO      |           1.154 |              1.281 |                1.008 |           -1 |
| PJM       |           1.157 |              1.761 |                1.021 |           -1 |
| FPL       |           1.178 |              1.528 |                1.074 |            0 |
| SC        |           1.2   |              1.102 |                1     |           -1 |
| FPC       |           1.207 |              1.098 |                1     |            0 |
| MISO      |           1.286 |              1.43  |                1.011 |           -5 |
| SCEG      |           1.347 |              1.714 |                1     |            0 |
| SOCO      |           1.417 |              1.542 |                1.006 |           -1 |
| NYIS      |           1.42  |              1.685 |                1.03  |            1 |
| GVL       |           1.432 |              1.009 |                1.01  |            0 |
| CISO      |           1.47  |              1.247 |                0.995 |            0 |
| PSEI      |           1.489 |              1.28  |                1     |            0 |
| SRP       |           1.506 |              3.054 |                1.093 |            3 |
| IPCO      |           1.527 |              1.063 |                1     |            0 |
| ISNE      |           1.565 |              1.63  |                1.025 |            0 |
| BPAT      |           1.664 |              1.186 |                1     |           -3 |
| JEA       |           1.686 |              1.597 |                1.301 |            0 |
| CPLE      |           1.83  |              2.838 |                1     |            0 |
| IID       |           1.995 |              1.053 |                1     |            0 |
| PACW      |           2.178 |              1.096 |                1     |            0 |
| AVA       |           3.451 |              1.245 |                1     |            0 |
| SCL       |          22.324 |              1.023 |                1     |            0 |
| NBSO      |          33.916 |              2.611 |                1     |            0 |
| TPWR      |         189.152 |              1.321 |                1     |            0 |
| AMPL      |        1883.53  |              1     |                1     |            0 |
| SEPA      |      441183     |              1.016 |                1     |            0 |
| HGMA      |         nan     |            nan     |              nan     |          nan |


---------------------------------------------
April 15, 2022
---------------------------------------------
- updated geothermal emissions factors
- updated clean energy emissions to zero

### Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   co2_mass_tons_unadjusted |
|:----------------------|---------------------:|-------------------:|----------------:|---------------------------:|
| !exact                |                10083 |               8073 |            7528 |                       8346 |
| +/-1%                 |                   28 |                544 |             595 |                        729 |
| +/-10%                |                   62 |                318 |             399 |                        474 |
| +/-50%                |                   41 |                278 |             323 |                        304 |
| <50%                  |                   18 |                 14 |              11 |                         19 |
| >50%                  |                   50 |                751 |            1154 |                        137 |
| missing               |                 2209 |               2264 |             903 |                        903 |
| missing_in_calc       |                   94 |                 83 |              49 |                         65 |
| missing_in_egrid      |                   27 |                 72 |             182 |                        182 |
| missing_zero_in_calc  |                   74 |                 30 |            1425 |                       1409 |
| missing_zero_in_egrid |                    2 |                268 |             123 |                        123 |
| negative              |                    8 |                  1 |               4 |                          5 |
| Total                 |                12696 |              12696 |           12696 |                      12696 |

### BA Metric
| ba_code   |   co2_mass_tons |   heat_input_mmbtu |   net_generation_mwh |
|:----------|----------------:|-------------------:|---------------------:|
| nan       |           0.302 |              0.356 |                0.316 |
| TEPC      |           0.859 |              0.818 |                0.697 |
| DEAA      |           0.997 |              0.997 |                1     |
| GRIF      |           0.999 |              0.999 |                1     |
| OVEC      |           1     |              1     |                1     |
| CSTO      |           1     |              1     |                1     |
| NSB       |           1     |              1     |                1     |
| SPA       |           1     |              1     |                1     |
| CEA       |           1     |              1     |                1     |
| LGEE      |           1.001 |              1.001 |                1     |
| SEC       |           1.001 |              0.999 |                1     |
| TIDC      |           1.001 |              1.001 |                1     |
| EEI       |           1.002 |              1.004 |                1     |
| AECI      |           1.003 |              1.003 |                1     |
| AVRN      |           1.003 |              1.001 |                1     |
| FMPP      |           1.008 |              1.003 |                1     |
| AEC       |           1.013 |              1.003 |                1     |
| WALC      |           1.016 |              1.006 |                1     |
| PSCO      |           1.028 |              1.014 |                1.015 |
| EPE       |           1.03  |              1.023 |                1     |
| LDWP      |           1.052 |              1.048 |                0.999 |
| PACE      |           1.06  |              1.063 |                0.999 |
| PNM       |           1.063 |              1.057 |                1.068 |
| NWMT      |           1.064 |              1.043 |                1     |
| HST       |           1.068 |              1     |                1     |
| TEC       |           1.073 |              1.036 |                1     |
| SWPP      |           1.103 |              1.145 |                1.007 |
| AZPS      |           1.106 |              1.112 |                1.041 |
| DUK       |           1.11  |              2.498 |                0.998 |
| PGE       |           1.113 |              1.085 |                1.222 |
| TAL       |           1.116 |              1.112 |                1     |
| HECO      |           1.118 |              1.049 |                1.024 |
| TVA       |           1.128 |              1.864 |                1     |
| NEVP      |           1.13  |              1.08  |                1.028 |
| BANC      |           1.137 |              1.086 |                1.042 |
| ERCO      |           1.151 |              1.278 |                1.006 |
| WACM      |           1.152 |              1.127 |                1.137 |
| PJM       |           1.157 |              1.761 |                1.021 |
| FPL       |           1.178 |              1.528 |                1.074 |
| SC        |           1.2   |              1.102 |                1     |
| FPC       |           1.207 |              1.098 |                1     |
| PSEI      |           1.237 |              1.113 |                0.903 |
| MISO      |           1.269 |              1.404 |                1.004 |
| SCEG      |           1.347 |              1.714 |                1     |
| SOCO      |           1.417 |              1.542 |                1.006 |
| NYIS      |           1.42  |              1.649 |                1.01  |
| GVL       |           1.432 |              1.009 |                1.01  |
| CISO      |           1.466 |              1.245 |                0.994 |
| SRP       |           1.506 |              3.054 |                1.093 |
| IPCO      |           1.519 |              1.062 |                0.999 |
| ISNE      |           1.564 |              1.629 |                1.025 |
| BPAT      |           1.664 |              1.186 |                1     |
| JEA       |           1.686 |              1.597 |                1.301 |
| CPLE      |           1.83  |              2.838 |                1     |
| IID       |           1.995 |              1.053 |                1     |
| PACW      |           2.178 |              1.096 |                1     |
| AVA       |           3.451 |              1.245 |                1     |
| SCL       |          22.324 |              1.023 |                1     |
| NBSO      |          33.916 |              2.611 |                1     |
| TPWR      |         189.152 |              1.321 |                1     |
| AMPL      |        1883.53  |              1     |                1     |
| SEPA      |         inf     |              1.016 |                1     |
| CHPD      |         nan     |              1     |                1     |
| CPLW      |         nan     |              1     |                1     |
| DOPD      |         nan     |              1     |                1     |
| GCPD      |         nan     |              1     |                1     |
| GRIS      |         nan     |              1     |                1     |
| GWA       |         nan     |              1     |                1     |
| HGMA      |         nan     |            nan     |              nan     |
| WAUW      |         nan     |              1     |                1     |
| WWA       |         nan     |              1     |                1     |
| YAD       |         nan     |              1     |                1     |
