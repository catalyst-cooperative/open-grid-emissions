---------------------------------------------
April 29, 2022
---------------------------------------------
- integrated pudl generation and fuel allocation

## Plant Metric
|                       |   net_generation_mwh |   fuel_consumed_mmbtu |   co2_mass_tons_adjusted |   co2_mass_tons |
|:----------------------|---------------------:|----------------------:|-------------------------:|----------------:|
| !exact                |                 9742 |                  8093 |                     7394 |            8299 |
| +/-1%                 |                   63 |                   557 |                      601 |             724 |
| +/-10%                |                   60 |                   326 |                      413 |             457 |
| +/-50%                |                   64 |                   272 |                      316 |             280 |
| <50%                  |                   15 |                     5 |                        3 |              10 |
| >50%                  |                   12 |                   744 |                     1153 |             110 |
| missing               |                    4 |                     9 |                        4 |               4 |
| missing_in_calc       |                   39 |                    29 |                        9 |              15 |
| missing_in_egrid      |                    3 |                    81 |                      190 |             190 |
| missing_zero_in_egrid |                  364 |                   297 |                      303 |             303 |
| negative              |                   55 |                     3 |                        5 |               5 |
| missing_zero_in_calc  |                    0 |                     5 |                       30 |              24 |
| Total                 |                10421 |                 10421 |                    10421 |           10421 |

## BA Metric
|       |   net_generation_mwh |   fuel_consumed_mmbtu |   co2_mass_tons |   num_plants |
|:------|---------------------:|----------------------:|----------------:|-------------:|
| AEC   |             1        |               1.007   |           1.019 |            0 |
| AECI  |             1        |               1.005   |           1.005 |            6 |
| AMPL  |             1        |               1       |        1883.53  |            0 |
| AVA   |             1        |               1.245   |           3.451 |            1 |
| AVRN  |             1        |               1.001   |           1.003 |            0 |
| AZPS  |             1.005    |               1.074   |           1.078 |            1 |
| BANC  |             0.996    |               1.042   |           1.083 |            2 |
| BPAT  |             1        |               1.198   |           1.748 |            7 |
| CEA   |             1        |               1       |           1     |            0 |
| CHPD  |             1        |               1       |           1     |            0 |
| CISO  |             1        |               1.248   |           1.469 |           55 |
| CPLE  |             0.973    |               2.769   |           1.763 |            8 |
| CPLW  |             1        |               1       |           1     |            0 |
| CSTO  |             1        |               1       |           1     |            0 |
| DEAA  |             1        |               0.997   |           0.997 |            0 |
| DOPD  |             1        |               1       |           1     |            0 |
| DUK   |             0.998    |               2.493   |           1.106 |            4 |
| EEI   |             1        |               1.004   |           1.002 |            0 |
| EPE   |             1        |               1.028   |           1.034 |            0 |
| ERCO  |             0.996    |               1.26    |           1.131 |            3 |
| FMPP  |             1        |               1.001   |           1.006 |            1 |
| FPC   |             0.993    |               1.098   |           1.207 |           -1 |
| FPL   |             1        |               1.448   |           1.093 |            3 |
| GCPD  |             1        |               1       |           1     |            0 |
| GRIF  |             1        |               0.999   |           0.999 |            0 |
| GRIS  |             1        |               1       |           1     |            0 |
| GVL   |             1.01     |               1.009   |           1.432 |            0 |
| GWA   |             1        |               1       |           1     |            0 |
| HECO  |             0.962    |               1.025   |           1.091 |            2 |
| HGMA  |             1        |             nan       |           1     |          nan |
| HST   |             1        |               1       |           1.068 |            0 |
| IID   |             1        |               1.053   |           1.996 |            1 |
| IPCO  |             0.999    |               1.062   |           1.519 |           -1 |
| ISNE  |             1.001    |               1.583   |           1.502 |           19 |
| JEA   |             1        |               1.261   |           1.398 |            0 |
| LDWP  |             1        |               1.058   |           1.061 |            8 |
| LGEE  |             1        |               1.002   |           1.001 |            0 |
| MISO  |             0.99     |               1.408   |           1.274 |           51 |
| NBSO  |             1        |               2.611   |          33.916 |            0 |
| NEVP  |             0.995    |               1.043   |           1.05  |            3 |
| NSB   |             1        |               1       |           1     |            0 |
| NWMT  |             1        |               1.037   |           1.056 |            1 |
| NYIS  |             0.962    |               1.584   |           1.308 |           29 |
| OVEC  |             1        |               1       |           1     |            0 |
| PACE  |             1.06     |               1.117   |           1.128 |            0 |
| PACW  |             1        |               1.096   |           2.178 |            3 |
| PGE   |             1        |               0.916   |           0.913 |            1 |
| PJM   |             0.989    |               1.727   |           1.131 |           29 |
| PNM   |             1        |               1.004   |           1.013 |            2 |
| PSCO  |             1.015    |               1.013   |           1.027 |            1 |
| PSEI  |             1        |               1.28    |           1.489 |            1 |
| SC    |             1        |               1.163   |           1.283 |            1 |
| SCEG  |             0.985    |               1.666   |           1.268 |            2 |
| SCL   |             1        |               1.029   |          28.353 |            0 |
| SEC   |             1        |               0.999   |           1.001 |            0 |
| SEPA  |             1        |               1.016   |      441183     |            1 |
| SOCO  |             1        |               1.529   |           1.396 |           15 |
| SPA   |             1        |               1       |           1     |            1 |
| SRP   |             1.093    |               3.053   |           1.505 |            4 |
| SWPP  |             0.998    |               1.142   |           1.102 |           23 |
| TAL   |             1        |               1.108   |           1.112 |            0 |
| TEC   |             0.99     |               1.031   |           1.08  |            0 |
| TEPC  |             0.635    |               0.818   |           0.859 |            0 |
| TIDC  |             1        |               1.017   |           1.02  |            0 |
| TPWR  |             1        |               1.321   |         185.159 |            0 |
| TVA   |             0.985    |               1.861   |           1.123 |            2 |
| WACM  |             1        |               1.001   |           1.001 |            3 |
| WALC  |             1        |               1.001   |           1.004 |            1 |
| WAUW  |             1        |               1       |           1     |            0 |
| WWA   |             1        |               1       |           1     |            0 |
| YAD   |             1        |               1       |           1     |            0 |
| nan   |             0.415    |               0.587   |           0.492 |           41 |
| Total |             0.990076 |               1.40067 |           1.185 |          nan |


---------------------------------------------
April 21, 2022
---------------------------------------------
- in gen fuel allocated, some generation was not getting allocated because 0/0 = NaN instead of 1.0 as the allocation fraction (plant 50933)
- fixing this led to more generators having an allocation fraction > 1.0
- not sure if this leads to more incorrect allocations - it seems that in all these cases, the net generation was zero

## Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons_adjusted |   co2_mass_tons |
|:----------------------|---------------------:|-------------------:|-------------------------:|----------------:|
| !exact                |                 9863 |               8115 |                     7413 |            8283 |
| +/-1%                 |                   22 |                596 |                      641 |             797 |
| +/-10%                |                   48 |                305 |                      393 |             437 |
| +/-50%                |                   54 |                269 |                      316 |             282 |
| <50%                  |                   11 |                  5 |                        3 |               9 |
| >50%                  |                    7 |                741 |                     1152 |             110 |
| missing               |                    1 |                  2 |                        1 |               1 |
| missing_in_calc       |                    2 |                  1 |                        1 |               1 |
| missing_in_egrid      |                    3 |                 58 |                      165 |             165 |
| missing_zero_in_egrid |                  361 |                324 |                      328 |             328 |
| negative              |                   46 |                  2 |                        4 |               4 |
| missing_zero_in_calc  |                    0 |                  0 |                        1 |               1 |
| Total                 |                10418 |              10418 |                    10418 |           10418 |

## BA Metric
|       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   num_plants |
|:------|---------------------:|-------------------:|----------------:|-------------:|
| nan   |             0.309    |            0.349   |          0.298  |            9 |
| TEPC  |             0.697    |            0.818   |          0.859  |            0 |
| PGE   |             1        |            0.916   |          0.913  |            5 |
| DEAA  |             1        |            0.997   |          0.997  |            0 |
| TIDC  |             1        |            0.998   |          0.998  |            0 |
| GRIF  |             1        |            0.999   |          0.999  |            0 |
| CSTO  |             1        |            1       |          1      |            0 |
| OVEC  |             1        |            1       |          1      |            0 |
| LGEE  |             1        |            1       |          1      |            0 |
| NSB   |             1        |            1       |          1      |            0 |
| SPA   |             1        |            1       |          1      |            1 |
| CEA   |             1        |            1       |          1      |            0 |
| WWA   |             1        |            1       |          1      |            0 |
| HGMA  |             1        |          nan       |          1      |          nan |
| GWA   |             1        |            1       |          1      |            0 |
| GRIS  |             1        |            1       |          1      |            0 |
| WAUW  |             1        |            1       |          1      |            0 |
| GCPD  |             1        |            1       |          1      |            0 |
| YAD   |             1        |            1       |          1      |            0 |
| DOPD  |             1        |            1       |          1      |            0 |
| CPLW  |             1        |            1       |          1      |            0 |
| CHPD  |             1        |            1       |          1      |            0 |
| WALC  |             1        |            1       |          1      |            1 |
| SEC   |             1        |            0.999   |          1.001  |            0 |
| WACM  |             1        |            1.001   |          1.001  |            4 |
| EEI   |             1        |            1.004   |          1.002  |            0 |
| AECI  |             1        |            1.003   |          1.003  |            6 |
| AVRN  |             1        |            1.001   |          1.003  |            0 |
| FMPP  |             1        |            1.001   |          1.006  |            1 |
| PNM   |             1        |            1.004   |          1.013  |            2 |
| AEC   |             1        |            1.006   |          1.018  |            0 |
| PSCO  |             1.009    |            1.014   |          1.028  |            3 |
| EPE   |             1        |            1.024   |          1.03   |            0 |
| TEC   |             1        |            1       |          1.036  |            1 |
| NEVP  |             0.996    |            1.042   |          1.047  |            3 |
| PACE  |             1        |            1.06    |          1.053  |            4 |
| LDWP  |             1        |            1.054   |          1.057  |            8 |
| NWMT  |             1        |            1.043   |          1.064  |            1 |
| HST   |             1        |            1       |          1.068  |            0 |
| AZPS  |             1.005    |            1.07    |          1.076  |            1 |
| BANC  |             0.999    |            1.04    |          1.08   |            2 |
| FPL   |             1        |            1.445   |          1.091  |            3 |
| HECO  |             1        |            1.025   |          1.092  |            2 |
| SWPP  |             0.998    |            1.141   |          1.101  |           26 |
| DUK   |             0.998    |            2.491   |          1.104  |            5 |
| TAL   |             1        |            1.108   |          1.112  |            0 |
| TVA   |             0.985    |            1.853   |          1.112  |            2 |
| ERCO  |             0.999    |            1.262   |          1.129  |            5 |
| PJM   |             0.99     |            1.727   |          1.131  |           38 |
| FPC   |             0.993    |            1.097   |          1.206  |            1 |
| SCEG  |             0.985    |            1.666   |          1.268  |            2 |
| SC    |             1        |            1.163   |          1.283  |            1 |
| MISO  |             0.996    |            1.433   |          1.293  |           68 |
| NYIS  |             0.983    |            1.614   |          1.3    |           31 |
| JEA   |             1        |            1.261   |          1.403  |            0 |
| SOCO  |             1.002    |            1.538   |          1.411  |           15 |
| GVL   |             1.01     |            1.009   |          1.432  |            0 |
| CISO  |             1        |            1.247   |          1.469  |           72 |
| PSEI  |             1        |            1.28    |          1.489  |            1 |
| ISNE  |             1.001    |            1.583   |          1.502  |           21 |
| SRP   |             1.093    |            3.052   |          1.504  |            4 |
| IPCO  |             1        |            1.063   |          1.527  |            0 |
| CPLE  |             0.973    |            2.765   |          1.757  |            8 |
| BPAT  |             1        |            1.205   |          1.808  |            8 |
| IID   |             1        |            1.053   |          1.996  |            1 |
| PACW  |             1        |            1.096   |          2.178  |            3 |
| AVA   |             1        |            1.245   |          3.451  |            1 |
| SCL   |             1        |            1.029   |         28.353  |            0 |
| NBSO  |             1        |            2.611   |         33.916  |            0 |
| TPWR  |             1        |            1.321   |        189.152  |            0 |
| AMPL  |             1        |            1       |       1883.53   |            0 |
| SEPA  |             1        |            1.016   |     441183      |            1 |
| Total |             0.991221 |            1.40246 |          1.1848 |          nan |


---------------------------------------------
April 20, 2022
---------------------------------------------
- continued to address net generation mismatches based on factors such as:
- incomplete EPA-EIA crosswalk
- double counting of data from CEMS and EIA

## Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons_adjusted |   co2_mass_tons |
|:----------------------|---------------------:|-------------------:|-------------------------:|----------------:|
| !exact                |                 9871 |               8100 |                     7401 |            8239 |
| +/-1%                 |                   34 |                575 |                      620 |             773 |
| +/-10%                |                   56 |                309 |                      394 |             456 |
| +/-50%                |                   45 |                279 |                      327 |             298 |
| <50%                  |                    3 |                  6 |                        4 |              13 |
| >50%                  |                   32 |                754 |                     1164 |             130 |
| missing               |                    1 |                  2 |                        1 |               1 |
| missing_in_calc       |                    2 |                  1 |                        1 |               9 |
| missing_in_egrid      |                    3 |                 57 |                      164 |             164 |
| missing_zero_in_calc  |                    8 |                  8 |                        9 |               1 |
| missing_zero_in_egrid |                  338 |                302 |                      306 |             306 |
| negative              |                    2 |                  2 |                        4 |               5 |
| Total                 |                10395 |              10395 |                    10395 |           10395 |

## BA Metric
|       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   num_plants |
|:------|---------------------:|-------------------:|----------------:|-------------:|
| nan   |              0.309   |            0.349   |         0.298   |            9 |
| TEPC  |              0.697   |            0.818   |         0.859   |            0 |
| DEAA  |              1       |            0.997   |         0.997   |            0 |
| GRIF  |              1       |            0.999   |         0.999   |            0 |
| OVEC  |              1       |            1       |         1       |            0 |
| CSTO  |              1       |            1       |         1       |            0 |
| NSB   |              1       |            1       |         1       |            0 |
| SPA   |              1       |            1       |         1       |            1 |
| CEA   |              1       |            1       |         1       |            0 |
| WAUW  |              1       |            1       |         1       |            0 |
| WWA   |              1       |            1       |         1       |            0 |
| GWA   |              1       |            1       |         1       |            0 |
| GRIS  |              1       |            1       |         1       |            0 |
| GCPD  |              1       |            1       |         1       |            0 |
| DOPD  |              1       |            1       |         1       |            0 |
| YAD   |              1       |            1       |         1       |            0 |
| CPLW  |              1       |            1       |         1       |            0 |
| CHPD  |              1       |            1       |         1       |            0 |
| LGEE  |              1       |            1.001   |         1.001   |            0 |
| SEC   |              1       |            0.999   |         1.001   |            0 |
| TIDC  |              1       |            1.001   |         1.001   |            0 |
| EEI   |              1       |            1.004   |         1.002   |            0 |
| AECI  |              1       |            1.003   |         1.003   |            6 |
| AVRN  |              1       |            1.001   |         1.003   |            0 |
| WACM  |              1.008   |            1.008   |         1.005   |            4 |
| FMPP  |              1       |            1.003   |         1.008   |            1 |
| AEC   |              1       |            1.003   |         1.013   |            0 |
| PNM   |              1       |            1.004   |         1.013   |            2 |
| WALC  |              1       |            1.006   |         1.016   |            1 |
| TEC   |              1       |            0.986   |         1.02    |            1 |
| PSCO  |              1.009   |            1.014   |         1.028   |            3 |
| EPE   |              1       |            1.023   |         1.03    |            0 |
| NEVP  |              0.996   |            1.043   |         1.048   |            2 |
| PACE  |              1       |            1.057   |         1.051   |            4 |
| LDWP  |              1       |            1.05    |         1.054   |            7 |
| NWMT  |              1       |            1.043   |         1.064   |            1 |
| HST   |              1       |            1       |         1.068   |            0 |
| BANC  |              0.999   |            1.043   |         1.084   |            2 |
| HECO  |              1       |            1.025   |         1.092   |            2 |
| SWPP  |              1.001   |            1.139   |         1.098   |           23 |
| DUK   |              0.998   |            2.492   |         1.105   |            5 |
| AZPS  |              1.041   |            1.112   |         1.106   |            1 |
| PGE   |              1.222   |            1.085   |         1.113   |            5 |
| TAL   |              1       |            1.112   |         1.116   |            0 |
| TVA   |              1.001   |            1.858   |         1.117   |            2 |
| ERCO  |              1.005   |            1.279   |         1.147   |            4 |
| PJM   |              1.022   |            1.758   |         1.158   |           38 |
| FPL   |              1.074   |            1.528   |         1.178   |            2 |
| SC    |              1       |            1.102   |         1.2     |            0 |
| FPC   |              1       |            1.099   |         1.208   |            1 |
| SCEG  |              1       |            1.667   |         1.269   |            2 |
| MISO  |              1.019   |            1.43    |         1.284   |           63 |
| NYIS  |              1.02    |            1.65    |         1.358   |           31 |
| JEA   |              1       |            1.26    |         1.401   |            0 |
| SOCO  |              1.006   |            1.536   |         1.408   |           14 |
| GVL   |              1.01    |            1.009   |         1.432   |            0 |
| CISO  |              1       |            1.247   |         1.47    |           62 |
| PSEI  |              1       |            1.28    |         1.489   |            1 |
| SRP   |              1.093   |            3.054   |         1.506   |            4 |
| ISNE  |              1.004   |            1.589   |         1.51    |           18 |
| IPCO  |              1       |            1.063   |         1.527   |            0 |
| BPAT  |              1       |            1.186   |         1.664   |            5 |
| CPLE  |              1.005   |            2.785   |         1.776   |            7 |
| IID   |              1       |            1.053   |         1.995   |            1 |
| PACW  |              1       |            1.096   |         2.178   |            3 |
| AVA   |              1       |            1.245   |         3.451   |            1 |
| SCL   |              1       |            1.023   |        22.324   |            0 |
| NBSO  |              1       |            2.611   |        33.916   |            0 |
| TPWR  |              1       |            1.321   |       189.152   |            0 |
| AMPL  |              1       |            1       |      1883.53    |            0 |
| SEPA  |              1       |            1.016   |    441183       |            1 |
| HGMA  |            nan       |          nan       |       nan       |          nan |
| Total |              1.00817 |            1.41206 |         1.19238 |          nan |


---------------------------------------------
April 19, 2022
---------------------------------------------
- fixing incorrect prime movers
- fixing matchup between EIA and EPA/eGRID ids
- removing non-grid connected plants

### Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   co2_mass_tons_unadjusted |
|:----------------------|---------------------:|-------------------:|----------------:|---------------------------:|
| !exact                |                 9854 |               8096 |            7398 |                       8232 |
| +/-1%                 |                   28 |                544 |             595 |                        730 |
| +/-10%                |                   62 |                318 |             399 |                        473 |
| +/-50%                |                   38 |                282 |             329 |                        310 |
| <50%                  |                    5 |                  6 |               4 |                         12 |
| >50%                  |                   49 |                776 |            1184 |                        151 |
| missing               |                    1 |                  2 |               1 |                          1 |
| missing_in_calc       |                    2 |                  1 |               1 |                         10 |
| missing_in_egrid      |                    3 |                 56 |             161 |                        161 |
| missing_zero_in_calc  |                    9 |                  9 |              10 |                          1 |
| missing_zero_in_egrid |                  337 |                302 |             308 |                        308 |
| negative              |                    6 |                  2 |               4 |                          5 |
| Total                 |                10394 |              10394 |           10394 |                      10394 |


### BA Metric
| ba_code   |   co2_mass_tons |   heat_input_mmbtu |   net_generation_mwh |   num_plants |
|:----------|----------------:|-------------------:|---------------------:|-------------:|
| nan       |           0.29  |              0.339 |                0.309 |            8 |
| TEPC      |           0.859 |              0.818 |                0.697 |            0 |
| DEAA      |           0.997 |              0.997 |                1     |            0 |
| GRIF      |           0.999 |              0.999 |                1     |            0 |
| OVEC      |           1     |              1     |                1     |            0 |
| CSTO      |           1     |              1     |                1     |            0 |
| NSB       |           1     |              1     |                1     |            0 |
| SPA       |           1     |              1     |                1     |            1 |
| CEA       |           1     |              1     |                1     |            0 |
| WAUW      |           1     |              1     |                1     |            0 |
| WWA       |           1     |              1     |                1     |            0 |
| GWA       |           1     |              1     |                1     |            0 |
| GRIS      |           1     |              1     |                1     |            0 |
| GCPD      |           1     |              1     |                1     |            0 |
| DOPD      |           1     |              1     |                1     |            0 |
| YAD       |           1     |              1     |                1     |            0 |
| CPLW      |           1     |              1     |                1     |            0 |
| CHPD      |           1     |              1     |                1     |            0 |
| LGEE      |           1.001 |              1.001 |                1     |            0 |
| SEC       |           1.001 |              0.999 |                1     |            0 |
| TIDC      |           1.001 |              1.001 |                1     |            0 |
| EEI       |           1.002 |              1.004 |                1     |            0 |
| AECI      |           1.003 |              1.003 |                1     |            6 |
| AVRN      |           1.003 |              1.001 |                1     |            0 |
| FMPP      |           1.008 |              1.003 |                1     |            1 |
| AEC       |           1.013 |              1.003 |                1     |            0 |
| WALC      |           1.016 |              1.006 |                1     |            1 |
| TEC       |           1.02  |              0.986 |                1     |            1 |
| PSCO      |           1.028 |              1.014 |                1.009 |            3 |
| EPE       |           1.03  |              1.023 |                1     |            0 |
| PACE      |           1.051 |              1.057 |                1     |            4 |
| LDWP      |           1.054 |              1.05  |                1     |            7 |
| PNM       |           1.063 |              1.057 |                1.068 |            2 |
| NWMT      |           1.064 |              1.043 |                1     |            1 |
| HST       |           1.068 |              1     |                1     |            0 |
| HECO      |           1.092 |              1.025 |                1     |            2 |
| SWPP      |           1.103 |              1.145 |                1.008 |           23 |
| AZPS      |           1.106 |              1.112 |                1.041 |            1 |
| DUK       |           1.11  |              2.499 |                0.998 |            5 |
| PGE       |           1.113 |              1.085 |                1.222 |            5 |
| TAL       |           1.116 |              1.112 |                1     |            0 |
| TVA       |           1.128 |              1.864 |                1     |            2 |
| NEVP      |           1.131 |              1.082 |                1.029 |            2 |
| BANC      |           1.137 |              1.087 |                1.042 |            2 |
| WACM      |           1.152 |              1.127 |                1.137 |            4 |
| ERCO      |           1.154 |              1.285 |                1.012 |            4 |
| PJM       |           1.159 |              1.764 |                1.022 |           37 |
| FPL       |           1.178 |              1.528 |                1.074 |            2 |
| SC        |           1.2   |              1.102 |                1     |            0 |
| FPC       |           1.207 |              1.098 |                1     |            1 |
| MISO      |           1.286 |              1.431 |                1.018 |           63 |
| SCEG      |           1.347 |              1.714 |                1     |            2 |
| SOCO      |           1.417 |              1.542 |                1.006 |           14 |
| NYIS      |           1.425 |              1.688 |                1.031 |           31 |
| GVL       |           1.432 |              1.009 |                1.01  |            0 |
| CISO      |           1.47  |              1.247 |                0.995 |           62 |
| PSEI      |           1.489 |              1.28  |                1     |            1 |
| SRP       |           1.506 |              3.054 |                1.093 |            4 |
| IPCO      |           1.527 |              1.063 |                1     |            0 |
| ISNE      |           1.567 |              1.631 |                1.025 |           18 |
| BPAT      |           1.664 |              1.186 |                1     |            5 |
| JEA       |           1.686 |              1.597 |                1.301 |            0 |
| CPLE      |           1.83  |              2.838 |                1     |            7 |
| IID       |           1.995 |              1.053 |                1     |            1 |
| PACW      |           2.178 |              1.096 |                1     |            3 |
| AVA       |           3.451 |              1.245 |                1     |            1 |
| SCL       |          22.324 |              1.023 |                1     |            0 |
| NBSO      |          33.916 |              2.611 |                1     |            0 |
| TPWR      |         189.152 |              1.321 |                1     |            0 |
| AMPL      |        1883.53  |              1     |                1     |            0 |
| SEPA      |      441183     |              1.016 |                1     |            1 |
| HGMA      |         nan     |            nan     |              nan     |          nan |



---------------------------------------------
April 16, 2022
---------------------------------------------
- updated output metrics to deal with null values and add more categories
- [x] Figure out why output metrics don't have the same number of plants
- [x] Downloaded updated version of pudl database (v6.0.0)
- [x] Manually fix incorrect BA assignments
- [x] Fix BA assignments
- [x] Add plant count to BA metric
- fixed issue where certain generators were being dropped from the EIA gen allocation

### Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   co2_mass_tons_unadjusted |
|:----------------------|---------------------:|-------------------:|----------------:|---------------------------:|
| !exact                |                10159 |               8102 |            7555 |                       8388 |
| +/-1%                 |                   27 |                543 |             594 |                        728 |
| +/-10%                |                   63 |                321 |             402 |                        476 |
| +/-50%                |                   42 |                280 |             327 |                        309 |
| <50%                  |                   15 |                 10 |               8 |                         16 |
| >50%                  |                   49 |                772 |            1180 |                        148 |
| missing               |                    1 |                 10 |               1 |                          1 |
| missing_in_calc       |                   46 |                 37 |              23 |                         32 |
| missing_in_egrid      |                   15 |                 61 |             174 |                        174 |
| missing_zero_in_calc  |                    9 |                  9 |              32 |                         23 |
| missing_zero_in_egrid |                    1 |                286 |             133 |                        133 |
| negative              |                    6 |                  2 |               4 |                          5 |
| Total                 |                10433 |              10433 |           10433 |                      10433 |

### BA Metric
| ba_code   |   co2_mass_tons |   heat_input_mmbtu |   net_generation_mwh |   num_plants |
|:----------|----------------:|-------------------:|---------------------:|-------------:|
| nan       |           0.309 |              0.363 |                0.322 |          -32 |
| TEPC      |           0.859 |              0.818 |                0.697 |            0 |
| DEAA      |           0.997 |              0.997 |                1     |            0 |
| GRIF      |           0.999 |              0.999 |                1     |            0 |
| OVEC      |           1     |              1     |                1     |            0 |
| CSTO      |           1     |              1     |                1     |            0 |
| NSB       |           1     |              1     |                1     |            0 |
| SPA       |           1     |              1     |                1     |            0 |
| CEA       |           1     |              1     |                1     |            0 |
| WAUW      |           1     |              1     |                1     |            0 |
| WWA       |           1     |              1     |                1     |            0 |
| GWA       |           1     |              1     |                1     |            0 |
| GRIS      |           1     |              1     |                1     |            0 |
| GCPD      |           1     |              1     |                1     |            0 |
| DOPD      |           1     |              1     |                1     |            0 |
| YAD       |           1     |              1     |                1     |            0 |
| CHPD      |           1     |              1     |                1     |            0 |
| CPLW      |           1     |              1     |                1     |            0 |
| LGEE      |           1.001 |              1.001 |                1     |            0 |
| SEC       |           1.001 |              0.999 |                1     |            0 |
| TIDC      |           1.001 |              1.001 |                1     |            0 |
| EEI       |           1.002 |              1.004 |                1     |            0 |
| AECI      |           1.003 |              1.003 |                1     |            0 |
| AVRN      |           1.003 |              1.001 |                1     |            0 |
| FMPP      |           1.008 |              1.003 |                1     |            0 |
| AEC       |           1.013 |              1.003 |                1     |            0 |
| WALC      |           1.016 |              1.006 |                1     |            0 |
| PSCO      |           1.028 |              1.014 |                1.009 |            0 |
| EPE       |           1.03  |              1.023 |                1     |            0 |
| PACE      |           1.051 |              1.057 |                1     |            0 |
| LDWP      |           1.054 |              1.05  |                1     |            0 |
| PNM       |           1.063 |              1.057 |                1.068 |            0 |
| NWMT      |           1.064 |              1.043 |                1     |            0 |
| HST       |           1.068 |              1     |                1     |            0 |
| TEC       |           1.073 |              1.036 |                1     |            0 |
| HECO      |           1.092 |              1.025 |                1     |            0 |
| SWPP      |           1.103 |              1.145 |                1.007 |           -1 |
| AZPS      |           1.106 |              1.112 |                1.041 |            0 |
| DUK       |           1.11  |              2.498 |                0.998 |            0 |
| PGE       |           1.113 |              1.085 |                1.222 |            0 |
| TAL       |           1.116 |              1.112 |                1     |            0 |
| TVA       |           1.128 |              1.864 |                1     |            0 |
| NEVP      |           1.131 |              1.082 |                1.029 |            0 |
| BANC      |           1.137 |              1.087 |                1.042 |            0 |
| WACM      |           1.152 |              1.127 |                1.137 |            0 |
| ERCO      |           1.154 |              1.281 |                1.008 |           -1 |
| PJM       |           1.157 |              1.761 |                1.021 |           -1 |
| FPL       |           1.178 |              1.528 |                1.074 |            0 |
| SC        |           1.2   |              1.102 |                1     |           -1 |
| FPC       |           1.207 |              1.098 |                1     |            0 |
| MISO      |           1.286 |              1.43  |                1.011 |           -5 |
| SCEG      |           1.347 |              1.714 |                1     |            0 |
| SOCO      |           1.417 |              1.542 |                1.006 |           -1 |
| NYIS      |           1.42  |              1.685 |                1.03  |            1 |
| GVL       |           1.432 |              1.009 |                1.01  |            0 |
| CISO      |           1.47  |              1.247 |                0.995 |            0 |
| PSEI      |           1.489 |              1.28  |                1     |            0 |
| SRP       |           1.506 |              3.054 |                1.093 |            3 |
| IPCO      |           1.527 |              1.063 |                1     |            0 |
| ISNE      |           1.565 |              1.63  |                1.025 |            0 |
| BPAT      |           1.664 |              1.186 |                1     |           -3 |
| JEA       |           1.686 |              1.597 |                1.301 |            0 |
| CPLE      |           1.83  |              2.838 |                1     |            0 |
| IID       |           1.995 |              1.053 |                1     |            0 |
| PACW      |           2.178 |              1.096 |                1     |            0 |
| AVA       |           3.451 |              1.245 |                1     |            0 |
| SCL       |          22.324 |              1.023 |                1     |            0 |
| NBSO      |          33.916 |              2.611 |                1     |            0 |
| TPWR      |         189.152 |              1.321 |                1     |            0 |
| AMPL      |        1883.53  |              1     |                1     |            0 |
| SEPA      |      441183     |              1.016 |                1     |            0 |
| HGMA      |         nan     |            nan     |              nan     |          nan |


---------------------------------------------
April 15, 2022
---------------------------------------------
- updated geothermal emissions factors
- updated clean energy emissions to zero

### Plant Metric
|                       |   net_generation_mwh |   heat_input_mmbtu |   co2_mass_tons |   co2_mass_tons_unadjusted |
|:----------------------|---------------------:|-------------------:|----------------:|---------------------------:|
| !exact                |                10083 |               8073 |            7528 |                       8346 |
| +/-1%                 |                   28 |                544 |             595 |                        729 |
| +/-10%                |                   62 |                318 |             399 |                        474 |
| +/-50%                |                   41 |                278 |             323 |                        304 |
| <50%                  |                   18 |                 14 |              11 |                         19 |
| >50%                  |                   50 |                751 |            1154 |                        137 |
| missing               |                 2209 |               2264 |             903 |                        903 |
| missing_in_calc       |                   94 |                 83 |              49 |                         65 |
| missing_in_egrid      |                   27 |                 72 |             182 |                        182 |
| missing_zero_in_calc  |                   74 |                 30 |            1425 |                       1409 |
| missing_zero_in_egrid |                    2 |                268 |             123 |                        123 |
| negative              |                    8 |                  1 |               4 |                          5 |
| Total                 |                12696 |              12696 |           12696 |                      12696 |

### BA Metric
| ba_code   |   co2_mass_tons |   heat_input_mmbtu |   net_generation_mwh |
|:----------|----------------:|-------------------:|---------------------:|
| nan       |           0.302 |              0.356 |                0.316 |
| TEPC      |           0.859 |              0.818 |                0.697 |
| DEAA      |           0.997 |              0.997 |                1     |
| GRIF      |           0.999 |              0.999 |                1     |
| OVEC      |           1     |              1     |                1     |
| CSTO      |           1     |              1     |                1     |
| NSB       |           1     |              1     |                1     |
| SPA       |           1     |              1     |                1     |
| CEA       |           1     |              1     |                1     |
| LGEE      |           1.001 |              1.001 |                1     |
| SEC       |           1.001 |              0.999 |                1     |
| TIDC      |           1.001 |              1.001 |                1     |
| EEI       |           1.002 |              1.004 |                1     |
| AECI      |           1.003 |              1.003 |                1     |
| AVRN      |           1.003 |              1.001 |                1     |
| FMPP      |           1.008 |              1.003 |                1     |
| AEC       |           1.013 |              1.003 |                1     |
| WALC      |           1.016 |              1.006 |                1     |
| PSCO      |           1.028 |              1.014 |                1.015 |
| EPE       |           1.03  |              1.023 |                1     |
| LDWP      |           1.052 |              1.048 |                0.999 |
| PACE      |           1.06  |              1.063 |                0.999 |
| PNM       |           1.063 |              1.057 |                1.068 |
| NWMT      |           1.064 |              1.043 |                1     |
| HST       |           1.068 |              1     |                1     |
| TEC       |           1.073 |              1.036 |                1     |
| SWPP      |           1.103 |              1.145 |                1.007 |
| AZPS      |           1.106 |              1.112 |                1.041 |
| DUK       |           1.11  |              2.498 |                0.998 |
| PGE       |           1.113 |              1.085 |                1.222 |
| TAL       |           1.116 |              1.112 |                1     |
| HECO      |           1.118 |              1.049 |                1.024 |
| TVA       |           1.128 |              1.864 |                1     |
| NEVP      |           1.13  |              1.08  |                1.028 |
| BANC      |           1.137 |              1.086 |                1.042 |
| ERCO      |           1.151 |              1.278 |                1.006 |
| WACM      |           1.152 |              1.127 |                1.137 |
| PJM       |           1.157 |              1.761 |                1.021 |
| FPL       |           1.178 |              1.528 |                1.074 |
| SC        |           1.2   |              1.102 |                1     |
| FPC       |           1.207 |              1.098 |                1     |
| PSEI      |           1.237 |              1.113 |                0.903 |
| MISO      |           1.269 |              1.404 |                1.004 |
| SCEG      |           1.347 |              1.714 |                1     |
| SOCO      |           1.417 |              1.542 |                1.006 |
| NYIS      |           1.42  |              1.649 |                1.01  |
| GVL       |           1.432 |              1.009 |                1.01  |
| CISO      |           1.466 |              1.245 |                0.994 |
| SRP       |           1.506 |              3.054 |                1.093 |
| IPCO      |           1.519 |              1.062 |                0.999 |
| ISNE      |           1.564 |              1.629 |                1.025 |
| BPAT      |           1.664 |              1.186 |                1     |
| JEA       |           1.686 |              1.597 |                1.301 |
| CPLE      |           1.83  |              2.838 |                1     |
| IID       |           1.995 |              1.053 |                1     |
| PACW      |           2.178 |              1.096 |                1     |
| AVA       |           3.451 |              1.245 |                1     |
| SCL       |          22.324 |              1.023 |                1     |
| NBSO      |          33.916 |              2.611 |                1     |
| TPWR      |         189.152 |              1.321 |                1     |
| AMPL      |        1883.53  |              1     |                1     |
| SEPA      |         inf     |              1.016 |                1     |
| CHPD      |         nan     |              1     |                1     |
| CPLW      |         nan     |              1     |                1     |
| DOPD      |         nan     |              1     |                1     |
| GCPD      |         nan     |              1     |                1     |
| GRIS      |         nan     |              1     |                1     |
| GWA       |         nan     |              1     |                1     |
| HGMA      |         nan     |            nan     |              nan     |
| WAUW      |         nan     |              1     |                1     |
| WWA       |         nan     |              1     |                1     |
| YAD       |         nan     |              1     |                1     |
